Setting up for development
--------------------------

npm install
export PATH=`pwd`/node_modules/.bin:$PATH
bower install

Rerun these after updating your checkout to make sure dependencies are kept
up-to-date.

Running in dev mode
-------------------

export PATH=`pwd`/node_modules/.bin:$PATH
grunt serve

Running tests
-------------

export PATH=`pwd`/node_modules/.bin:$PATH

once:

  grunt test

continous:

  grunt karma

If you want debug logging on the console, create test/debug.js with:

echo "window.DEBUG = 'mushin:*'" > test/debug.js

Documentation
-------------

Currently using ng-docs.

- build docs:

grunt ngdocs

- read them:
  grunt serve
  browse to http://localhost:8999/docs/

Reset database from backup
--------------------------
export HOODIE_PASSWORD=...
export HOODIE_DB=user/xbnjwxg
export HOODIE_DB_QUOTE=user%2Fxbnjwxg
curl -X DELETE http://admin:$HOODIE_PASSWORD@localhost:6006/$HOODIE_DB_QUOTE
curl -X PUT http://admin:$HOODIE_PASSWORD@localhost:6006/$HOODIE_DB_QUOTE
couchdb-load -u admin -p $HOODIE_PASSWORD http://localhost:6006/$HOODIE_DB_QUOTE < xbnjwxg.dump

Log out from mushin-hoodie, log back in to have empty db

Migrate from mushin couchdb
---------------------------
drop/recreate mushin-hoodie if needed

  curl -X DELETE http://localhost:5984/mushin-hoodie
  curl -X PUT http://localhost:5984/mushin-hoodie

copy mushin to mushin-hoodie

  paisley -D mushin replicate add -t single -d forward localhost/mushin-hoodie

transform all docs

   paisley -D mushin-hoodie document apply examples/mushin-hoodie.py

delete all non-transformed docs, which are peeled back conflicted docs

  paisley -D mushin-hoodie document delete --dry-run examples/delete-non-mushin-hoodie.py

replicate

  paisley -D $HOODIE_DB -u admin -p $HOODIE_PASSWORD -P 6006 replicate add -t single -d backward localhost/mushin-hoodie
  FIXME: doesn't work; they don't show up.  Only after making a trivial edit does it show up in mushin-hoodie

  instead, dump and load

  couchdb-dump http://localhost:5984/mushin-hoodie > mushin-hoodie.dump
  couchdb-load -u admin -p $HOODIE_PASSWORD http://localhost:6006/$HOODIE_DB_QUOTE < mushin-hoodie.dump

Adding dependencies
-------------------

Example:
  npm install karma karma-coverage --save-dev
Tests
-----

Tests are under test/spec/


Known Issues
------------

- grunt test fails with
  Loading "connect_proxy.js" tasks...ERROR

  See https://github.com/beeman/loopback-angular-admin/issues/68
  Do
  rm -rf node_modules/grunt-connect-proxy
  npm install eventemitter3@0.1.6
  npm install grunt-connect-proxy

- grunt test fails with undefined reference to Hoodie
  most likely hoodie.js does not exist; see karma.conf.js to see how it is
  loaded, and make sure the file that is referenced there exists.
  For example, bower hoodie 1.0.4 changed from dist/ to src/ which broke this.

- Module 'template-module' is not available
  This module is generated by nghtml2js in karma.conf.js
  Make sure it's installed: npm install karma-ng-html2js-preprocessor#~0.1

Test views
----------
/test/things; e.g. http://0.0.0.0:8999/#/test/things

material icons
--------------
 * See http://google.github.io/material-design-icons/; method 2
   bower insstall material-design-icons
   create app/styles/material-design-icons, replacing online url with
   /bower_components/material-design-icons/iconfont/
   refresh; seems to work

